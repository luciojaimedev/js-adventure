<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interactive Map - Gastro Center of Maryland</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
      .leaflet-control-attribution {
        display: none;
      }

      /* Marker hover & active */
      .leaflet-marker-icon > svg {
        transition: 0.2s ease;
        border-radius: 50%;
        cursor: pointer;
        padding: 4px;
      }

      .leaflet-marker-icon > svg:hover,
      .leaflet-marker-icon > svg.active {
        transform: scale(1.5);
        background-color: #59757921;
        border: 1px solid white;
      }

      .leaflet-popup-content-wrapper,
      .leaflet-popup-tip {
        box-shadow: rgba(149, 157, 165, 0.2) 0px 8px 24px;
      }

      /* Popups */
      .leaflet-popup {
        border-radius: var(--br-s);
        padding: 10px;
        font-family: "Arial", sans-serif;
        color: var(--color-neutral-primary);
      }

      .leaflet-popup span {
        display: none;
      }

      .leaflet-popup-content {
        font-size: 14px;
        line-height: 165%;
      }

      .leaflet-popup-content b {
        font-size: 16px;
        color: var(--color-primary);
      }

      .leaflet-popup-content a {
        text-decoration: underline;
        color: var(--color-neutral-primary);
      }
    </style>
  </head>
  <body>
    <div id="map" style="width: 100%; height: 600px"></div>

    <script>
      const map = L.map("map").setView([39.25, -76.7], 10);

      L.tileLayer(
        "https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",
        {
          subdomains: "abcd",
          attribution:
            '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/">CARTO</a>',
        }
      ).addTo(map);

      const svgMarker = `
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="40" height="40">
          <path d="M14 11.5A2.5 2.5 0 0 0 16.5 9A2.5 2.5 0 0 0 14 6.5A2.5 2.5 0 0 0 11.5 9a2.5 2.5 0 0 0 2.5 2.5M14 2c3.86 0 7 3.13 7 7c0 5.25-7 13-7 13S7 14.25 7 9a7 7 0 0 1 7-7M5 9c0 4.5 5.08 10.66 6 11.81L10 22S3 14.25 3 9c0-3.17 2.11-5.85 5-6.71C6.16 3.94 5 6.33 5 9" fill="#088"/>
        </svg>
      `;

      const svgDivIcon = L.divIcon({
        html: svgMarker,
        className: "",
        iconSize: [40, 40],
        iconAnchor: [20, 40],
        popupAnchor: [0, -40],
      });

      const locations = [
        {
          lat: 38.9618534,
          lon: -76.5118343,
          name: "Gastro Center of Maryland - Annapolis",
          address: "123 Main St, Annapolis, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps?client=firefox-b-d&sca_esv=71556d6a5c4e6ebd&output=search&q=gastro+center+of+maryland+annapolis&source=lnms",
        },
        {
          lat: 39.0069606,
          lon: -77.1127837,
          name: "Gastro Center of Maryland - Bethesda",
          address: "456 Bethesda Ave, Bethesda, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Center+of+Maryland/@39.0271905,-77.1390457,14z",
        },
        {
          lat: 39.1789735,
          lon: -76.8453947,
          name: "Gastro Center of Maryland - Columbia",
          address: "789 Columbia Rd, Columbia, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Centers+of+Maryland/@39.1789735,-76.847975,17z",
        },
        {
          lat: 39.1510226,
          lon: -77.2091682,
          name: "Gastro Center of Maryland - Gaithersburg",
          address: "101 Gaithersburg Rd, Gaithersburg, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Center+of+Maryland/@39.1510226,-77.2117485,17z",
        },
        {
          lat: 39.1562461,
          lon: -77.0673198,
          name: "Gastro Center of Maryland - Olney",
          address: "202 Olney Rd, Olney, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Center+of+Maryland/@39.1562461,-77.0699001,17z",
        },
        {
          lat: 38.9678303,
          lon: -76.9189989,
          name: "Gastro Center of Maryland - Riverdale",
          address: "303 Riverdale Rd, Riverdale, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Center+of+Maryland/@38.9678303,-76.9215792,17z",
        },
        {
          lat: 39.0240081,
          lon: -77.0450657,
          name: "Gastro Center of Maryland - Silver Spring",
          address: "404 Silver Spring Ave, Silver Spring, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Center+of+Maryland/@39.0240081,-77.047646,17z",
        },
        {
          lat: 39.4168018,
          lon: -76.6152741,
          name: "Gastro Center of Maryland - Timonium/Lutherville",
          address: "505 Timonium Rd, Timonium, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Centers+of+Maryland+-+Timonium%2FLutherville/@39.4168018,-76.6178544,17z",
        },
        {
          lat: 39.373982,
          lon: -76.4591822,
          name: "Gastro Center of Maryland - Baltimore",
          address: "606 White Marsh Rd, Baltimore, MD",
          phone: "410-290-6677",
          gbpUrl:
            "https://www.google.com/maps/place/Gastro+Center+of+Maryland/@39.373982,-76.4617625,17z",
        },
      ];

      // Guardamos los markers
      const markers = [];

      locations.forEach((loc) => {
        const popupContent = `
          <b>${loc.name}</b><br>
          <a href="${loc.gbpUrl}" target="_blank">${loc.address}</a><br>
          <a href="tel:${loc.phoneClean}">${loc.phone}</a>
        `;
        const marker = L.marker([loc.lat, loc.lon], { icon: svgDivIcon })
          .addTo(map)
          .bindPopup(popupContent);
        markers.push(marker);
      });

      // FunciÃ³n para quitar active de todos los SVG
      function deactivateAllMarkers() {
        document
          .querySelectorAll(".leaflet-marker-icon > svg.active")
          .forEach((svg) => {
            svg.classList.remove("active");
          });
      }

      // Click en marker activa hover persistente
      markers.forEach((marker) => {
        marker.on("click", (e) => {
          deactivateAllMarkers();
          const svg = e.target._icon.querySelector("svg");
          svg.classList.add("active");
        });
      });

      // Click fuera del marker desactiva
      map.on("click", () => {
        deactivateAllMarkers();
      });
    </script>
  </body>
</html>
